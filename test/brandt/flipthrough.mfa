program Brandt

group UpLifter [Top,Bottom,Left,Right]
group Dummy [Left,Right]

sequence FlipThrough {
	byte QUART;
	byte HALF;
	
	module.gradientInit();
	module.gradientPropagate();
	
	do {		
		if (module.gradPri==3 && module.gradSec==0) module.id = @Clover.West;
		if (module.gradPri==2 && module.gradSec==0) module.id = @Clover.South;
		if (module.gradPri==3 && module.gradSec==1) module.id = @Clover.North;
		if (module.gradPri==2 && module.gradSec==1) module.id = @Clover.East;
		module.isRef = (module.gradPri == 0 && module.gradSec == 3);
	}
	
	do  {				
		disconnect(@UpLifter.Left, NORTH&MALE&EAST|SOUTH&MALE&WEST);
		disconnect(@UpLifter.Right, NORTH&MALE&EAST);
	} 
	
	do  {				
		rotate(@UpLifter.Left, QUART);
		rotate(@UpLifter.Right, QUART);
	} 
	
	disconnect(@UpLifter.Top, NORTH);
	rotate(@UpLifter.Top, HALF);
	
	do  {				
		rotate(@UpLifter.Left, -QUART);
		rotate(@UpLifter.Right, -QUART);
	} 
	
	do  {				
		rotate(@UpLifter.Right, -HALF);
		rotate(@UpLifter.Bottom, HALF);
	} 
	
	connect(@X, @UpLifter);	
	
	region.finish();	
}