package FourWheeler



byte STEER_DEGREES = 12 


sequence Choose {
	goto Drive;
}

sequence Drive {
	when (module.id == @Axis.Front && module.proximity() > PROXIMITY) {
		goto Turn;
	} 
	
	do { 
		when {
			case #(connSource:SOUTH&EAST&FEMALE, connDest:EAST)>0:								module.group = @LeftWheel;
			case #(connSource:SOUTH&EAST&FEMALE, connDest:WEST)>0:								module.group = @RightWheel;
			case (#(@RightWheel)>0 || #(@LeftWheel)>0) && #(connSource: NORTH&EAST&FEMALE)==0:	module.id = @Axis.Front;
			case (#(@RightWheel)>0 || #(@LeftWheel)>0) && #(connSource: NORTH&EAST&FEMALE)==1:	module.id = @Axis.Back;
			case #()==2: 																		module.id = @Axis.Driver;	
		}
	} until (config.assignTime);
	
	
	meta.drive(FORWARD,FORWARD);
}



sequence Turn {	
	meta.halt(); 
	meta.steer(STEER_DEGREES);
		
	do {
		meta.drive (BACKWARD,BACKWARD);	
	} wait(TIME_BACKWARD);
	
	meta.halt();
	
	meta.steer(-STEER_DEGREES);
	
	goto Drive;
}
